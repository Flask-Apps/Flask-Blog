<ul class="posts">
  {% for post in posts %}
  <li class="post">
    <div class="profile-thumbnail">
      <a href="{{ url_for('.user', username=post.author.username) }}">
        <img
          src="{{ post.author.gravatar(size=40) }}"
          alt=""
          class="img-rounded profile-thumbnail"
        />
      </a>
    </div>
    <div class="post-content">
      <div class="post-date">{{ moment(post.timestamp).fromNow() }}</div>
      <div class="post-author">
        <a href="{{ url_for('.user', username=post.author.username) }}">
          {{ post.author.username }}
        </a>
      </div>
      <div class="post-body">
        {% if post.body_html %}
        <!-- `|` safe to not escape the html elements otherwise they
              appear as tags (its safe as the markdown generated html
              is generated by the server)
        -->
        {{ post.body_html | safe }} {% else %} {{ post.body }} {% endif %}
      </div>
      <div class="post-footer">
        {% if current_user == post.author %}
        <a
          href="{{ url_for('.edit', id=post.id) }}"
          class="label-primary label"
        >
          Edit
        </a>
        {% elif current_user.is_administrator() %}
        <a href="{{ url_for('.edit', id=post.id) }}">
          <span class="label label-danger"> Edit [Admin]</span></a
        >
        {% endif %}
        <a href="{{ url_for('.post', id=post.id) }}">
          <span class="label label-default">Permalink</span>
        </a>
        <!-- browser looks for an element with the id given and scrolls 
            the page so that element appears at the top of the page
        -->
        <a href="{{ url_for('.post', id=post.id) }}#comments">
          <span class="label-primary label">
            {{ post.comments.count() }} Comments
          </span>
        </a>
      </div>
    </div>
  </li>
  {% endfor %}
</ul>
